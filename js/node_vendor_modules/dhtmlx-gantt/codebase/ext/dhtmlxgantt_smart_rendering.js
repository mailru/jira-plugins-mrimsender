/*!
 * @license
 * 
 * dhtmlxGantt v.5.1.2 Professional
 * This software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.
 * 
 * (c) Dinamenta, UAB.
 * 
 */
Gantt.plugin(function(e){!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=31)}({31:function(e,t,n){e.exports=n(32)},32:function(t,n){e.config.smart_rendering=!0,e._smart_render={getViewPort:function(){var t=e.$ui.getView("timeline")||e.$ui.getView("grid")||e.$layout,n=t.getSize(),i=e.getScrollState();return{y:i.y,y_end:i.y+n.y}},getScrollSizes:function(){var t=e.getScrollState();return t.x=t.x||0,t.y=t.y||e.getVisibleTaskCount()*e.config.row_height,t},isInViewPort:function(e,t){return!!(e.y<t.y_end&&e.y_end>t.y)},isTaskDisplayed:function(t,n){return!(!e.$keyboardNavigation||!e.$keyboardNavigation.dispatcher.isTaskFocused(t))||this.isInViewPort(this.getTaskPosition(t),this.getViewPort())},isLinkDisplayed:function(e,t){return this.isInViewPort(this.getLinkPosition(e,t),this.getViewPort())},getTaskPosition:function(t){var n=e.getTaskTop(t);return{y:n,y_end:n+e.config.row_height}},getLinkPosition:function(t,n){var i=e.getTaskTop(n.source),a=e.getTaskTop(n.target);return{y:Math.min(i,a),y_end:Math.max(i,a)+e.config.row_height}},getRange:function(t){t=t||0;for(var n=this.getViewPort(),i=Math.floor(Math.max(0,n.y)/e.config.row_height)-t,a=Math.ceil(Math.max(0,n.y_end)/e.config.row_height)+t,r=e.$data.tasksStore.getIndexRange(i,a),s=[],o=0;o<r.length;o++)s.push(r[o].id);return s},_redrawItems:function(e,t){for(var n={},i=0;i<t.length;i++)n[t[i].id]=!0;for(var a={},r=0;r<e.length;r++){var s=e[r];for(var o in s.rendered)if(n[o]){var c=s.rendered[o];c&&c.parentNode&&(a[o]=!0)}else s.hide(o);for(var i=0;i<t.length;i++)a[t[i].id]||s.restore(t[i])}},_getVisibleTasks:function(){for(var t=this.getRange(),n=[],i=0;i<t.length;i++){var a=e.getTask(t[i]);a.$index=i,e.resetProjectDates(a),n.push(a)}return n},_getVisibleLinks:function(){for(var t=[],n=e.$data.linksStore.getIndexRange(),i=0;i<n.length;i++)this.isLinkDisplayed(n[i].id,n[i])&&t.push(n[i]);return t},_recalculateLinkedProjects:function(t){for(var n={},i=0;i<t.length;i++)n[t[i].source]=!0,n[t[i].target]=!0;for(var i in n)e.isTaskExists(i)&&e.resetProjectDates(e.getTask(i))},updateRender:function(){e.callEvent("onBeforeSmartRender",[]);var t=this._getVisibleTasks(),n=this._getVisibleLinks();this._recalculateLinkedProjects(n);var i=e.$services.getService("layers"),a=i.getDataRender("task"),r=i.getDataRender("link");this._redrawItems(a.getLayers(),t),this._redrawItems(r.getLayers(),n),e.callEvent("onSmartRender",[])},cached:{},_takeFromCache:function(e,t,n){this.cached[n]||(this.cached[n]=null);var i=this.cached[n];return void 0!==e?(i||(i=this.cached[n]={}),void 0===i[e]&&(i[e]=t(e)),i[e]):(i||(i=t()),i)},initCache:function(){for(var t=["getLinkPosition","getTaskPosition","isTaskDisplayed","isLinkDisplayed","getViewPort","getScrollSizes"],n=0;n<t.length;n++){var i=t[n],a=e.bind(this[i],this);this[i]=function(e,t){return function(n){return this._takeFromCache(n,e,t)}}(a,i)}this.invalidateCache(),this.initCache=function(){}},invalidateCache:function(){function t(){s.cached.getViewPort=null,s.cached.getScrollSizes=null,s.cached.isTaskDisplayed=null,s.cached.isLinkDisplayed=null}function n(){s.cached.isTaskDisplayed=null,s.cached.isLinkDisplayed=null,s.cached.getLinkPosition=null,s.cached.getTaskPosition=null}function i(){t(),n()}function a(e){s.cached.isTaskDisplayed&&(s.cached.isTaskDisplayed[e]=void 0),s.cached.getTaskPosition&&(s.cached.getTaskPosition[e]=void 0)}function r(e){s.cached.isLinkDisplayed&&(s.cached.isLinkDisplayed[e]=void 0),s.cached.getLinkPosition&&(s.cached.getLinkPosition[e]=void 0)}var s=this;e.attachEvent("onClear",function(){i()}),e.attachEvent("onParse",function(){i()}),e.attachEvent("onAfterLinkUpdate",r),e.attachEvent("onAfterTaskAdd",i),e.attachEvent("onAfterTaskDelete",i),e.attachEvent("onAfterTaskUpdate",a),e.attachEvent("onGanttScroll",t),e.attachEvent("onDataRender",i),this.invalidateCache=function(){}}},e.attachEvent("onGanttScroll",function(t,n,i,a){if(e.config.smart_rendering&&(n!=a||t==i)){e._smart_render.getRange();e._smart_render.updateRender()}}),e.attachEvent("onDataRender",function(){e.config.smart_rendering&&e._smart_render.updateRender()}),function(){var t=e.attachEvent("onGanttReady",function(){var n=e.$services.getService("layers");n.getDataRender("task").filters.push(function(t,n){return!e.config.smart_rendering||!!e._smart_render.isTaskDisplayed(t,n)}),n.getDataRender("link").filters.push(function(t,n){return!e.config.smart_rendering||!!e._smart_render.isLinkDisplayed(t,n)}),e.detachEvent(t)})}()}})});
//# sourceMappingURL=dhtmlxgantt_smart_rendering.js.map